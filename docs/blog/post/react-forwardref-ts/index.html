<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 4.25.4"/><meta data-react-helmet="true" name="description" content="Create wrapper components that can forward ref and infer their prop typings from the injectable wrapped component.
"/><meta data-react-helmet="true" property="og:site_name" content="Philipp Fritsche"/><meta data-react-helmet="true" property="og:title" content="Component injection with React.forwardRef"/><meta data-react-helmet="true" property="og:description" content="Create wrapper components that can forward ref and infer their prop typings from the injectable wrapped component.
"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:image" content="https://source.unsplash.com/ZBstHWt9vLc/1200x630"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="@ph_fritsche"/><meta data-react-helmet="true" name="twitter:site" content="@ph_fritsche"/><meta data-react-helmet="true" name="twitter:title" content="Component injection with React.forwardRef"/><meta data-react-helmet="true" name="twitter:description" content="Create wrapper components that can forward ref and infer their prop typings from the injectable wrapped component.
"/><meta name="theme-color" content="hsl(180, 100%, 80%)"/><style data-emotion="css 549zl8 14bhodi 1qw96cp c7dfze 3zukih 1rtnrqa 4l7b43 faujvq 11qjisw 1rcf3o0 wmsu9q 9l3uo3 15kjgm 4unpuk 1ecc1vw q9xt0v rlubtd 1ujsas3 6xugel vubbuv">.css-549zl8{padding-top:8px;padding-bottom:8px;break-inside:avoid;}.css-14bhodi{background-color:#fff;color:rgba(0, 0, 0, 0.87);-webkit-transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;border-radius:4px;box-shadow:0px 2px 1px -1px rgba(0,0,0,0.2),0px 1px 1px 0px rgba(0,0,0,0.14),0px 1px 3px 0px rgba(0,0,0,0.12);overflow:hidden;}.css-14bhodi>MuiCardActionArea-root,.css-14bhodi >MuiCardActionArea-root>*{padding-top:0!important;padding-bottom:0!important;margin-top:8px;margin-bottom:8px;}.css-1qw96cp{padding:16px;}.css-1qw96cp:last-child{padding-bottom:24px;}.css-c7dfze{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:500;font-size:0.875rem;line-height:1.57;letter-spacing:0.00714em;}.css-3zukih{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:8px;}.css-3zukih>:not(:first-of-type){margin-left:8px;}.css-1rtnrqa{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;background-color:transparent;outline:0;border:0;margin:0;border-radius:0;padding:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;-moz-appearance:none;-webkit-appearance:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:500;font-size:0.8125rem;line-height:1.75;letter-spacing:0.02857em;text-transform:uppercase;min-width:64px;padding:4px 5px;border-radius:4px;-webkit-transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;color:#1976d2;}.css-1rtnrqa::-moz-focus-inner{border-style:none;}.css-1rtnrqa.Mui-disabled{pointer-events:none;cursor:default;}@media print{.css-1rtnrqa{-webkit-print-color-adjust:exact;color-adjust:exact;}}.css-1rtnrqa:hover{-webkit-text-decoration:none;text-decoration:none;background-color:rgba(25, 118, 210, 0.04);}@media (hover: none){.css-1rtnrqa:hover{background-color:transparent;}}.css-1rtnrqa.Mui-disabled{color:rgba(0, 0, 0, 0.26);}.css-4l7b43{display:block;-webkit-background-size:cover;background-size:cover;background-repeat:no-repeat;-webkit-background-position:center;background-position:center;width:100%;object-fit:cover;margin-bottom:-6.6000000000000005rem;max-height:400px;height:calc((100vw - 32px) * 0.5);}@media (max-width:599.95px){.css-4l7b43{height:calc((100vw - 16px) * 0.5);}}@media (max-width:-0.05px){.css-4l7b43{height:calc((100vw - 8px) * 0.5);}}.css-faujvq{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:16px;}.css-11qjisw{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;}.css-1rcf3o0{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:300;font-size:6rem;line-height:1.167;letter-spacing:-0.01562em;display:block;color:#1976d2;font-weight:normal;text-shadow:0px -2px 2px #fff,0px 2px 2px #fff,2px 2px 2px #fff,2px 0px 2px #fff,2px -2px 2px #fff,-2px 2px 2px #fff,-2px 0px 2px #fff,-2px -2px 2px #fff;}.css-wmsu9q{padding-bottom:1.5em!important;padding-top:1.5em!important;}.css-9l3uo3{margin:0;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:400;font-size:1rem;line-height:1.5;letter-spacing:0.00938em;}.css-15kjgm{margin:0;color:#1976d2;-webkit-text-decoration:underline;text-decoration:underline;text-decoration-color:rgba(25, 118, 210, 0.4);}.css-15kjgm:hover{text-decoration-color:inherit;}.css-4unpuk{position:relative;}.css-4unpuk code{display:block!important;padding-top:1em!important;padding-bottom:1em!important;max-width:100%;overflow:auto;font-size:0.9em;}.css-1ecc1vw{position:absolute;top:0;right:5%;padding:0px 8px;border-bottom-right-radius:4px;border-bottom-left-radius:4px;background:#1976d2;color:#fff;text-transform:uppercase;box-shadow:0px 1px 2px hsla(0, 0%, 0%, 50%);}.css-q9xt0v{display:inline-block;padding:0px 4px;border-radius:4px;background-color:hsla(0, 0%, 0%, 7%)!important;font-family:'Inconsolata',monospace;font-weight:400;}.css-rlubtd{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:8px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row-reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse;}.css-rlubtd>:not(:first-of-type){margin-left:8px;}.css-1ujsas3{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;background-color:transparent;outline:0;border:0;margin:0;border-radius:0;padding:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;-moz-appearance:none;-webkit-appearance:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;font-family:"Roboto","Helvetica","Arial",sans-serif;font-weight:500;font-size:0.875rem;line-height:1.75;letter-spacing:0.02857em;text-transform:uppercase;min-width:64px;padding:6px 8px;border-radius:4px;-webkit-transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,box-shadow 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,border-color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms,color 250ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;color:#1976d2;}.css-1ujsas3::-moz-focus-inner{border-style:none;}.css-1ujsas3.Mui-disabled{pointer-events:none;cursor:default;}@media print{.css-1ujsas3{-webkit-print-color-adjust:exact;color-adjust:exact;}}.css-1ujsas3:hover{-webkit-text-decoration:none;text-decoration:none;background-color:rgba(25, 118, 210, 0.04);}@media (hover: none){.css-1ujsas3:hover{background-color:transparent;}}.css-1ujsas3.Mui-disabled{color:rgba(0, 0, 0, 0.26);}.css-6xugel{display:inherit;margin-right:8px;margin-left:-4px;}.css-6xugel>*:nth-of-type(1){font-size:20px;}.css-vubbuv{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;font-size:1.5rem;}</style><title data-react-helmet="true">Component injection with React.forwardRef | Philipp Fritsche</title><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="icon" href="/favicon-32x32.png?v=9ad503c915d1a1d6359e10e829e7a91b" type="image/png"/><link rel="icon" href="/favicon.svg?v=9ad503c915d1a1d6359e10e829e7a91b" type="image/svg+xml"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=9ad503c915d1a1d6359e10e829e7a91b"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=9ad503c915d1a1d6359e10e829e7a91b"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=9ad503c915d1a1d6359e10e829e7a91b"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=9ad503c915d1a1d6359e10e829e7a91b"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=9ad503c915d1a1d6359e10e829e7a91b"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=9ad503c915d1a1d6359e10e829e7a91b"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=9ad503c915d1a1d6359e10e829e7a91b"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=9ad503c915d1a1d6359e10e829e7a91b"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><article class="MuiBox-root css-549zl8"><div class="MuiPaper-root MuiPaper-elevation MuiPaper-rounded MuiPaper-elevation1 MuiCard-root css-14bhodi"><div class="MuiCardContent-root css-1qw96cp"><h6 class="MuiTypography-root MuiTypography-subtitle2 css-c7dfze">8/5/2021</h6></div><div class="MuiCardActions-root MuiCardActions-spacing css-3zukih"><a class="MuiButtonBase-root MuiButton-root MuiButton-text MuiButton-textPrimary MuiButton-sizeSmall MuiButton-textSizeSmall MuiButton-root MuiButton-text MuiButton-textPrimary MuiButton-sizeSmall MuiButton-textSizeSmall css-1rtnrqa" tabindex="0" href="/blog/tag/react">#<!-- -->react</a><a class="MuiButtonBase-root MuiButton-root MuiButton-text MuiButton-textPrimary MuiButton-sizeSmall MuiButton-textSizeSmall MuiButton-root MuiButton-text MuiButton-textPrimary MuiButton-sizeSmall MuiButton-textSizeSmall css-1rtnrqa" tabindex="0" href="/blog/tag/typescript">#<!-- -->typescript</a></div><img class="MuiCardMedia-root MuiCardMedia-media MuiCardMedia-img css-4l7b43" src="https://source.unsplash.com/ZBstHWt9vLc/400x200" srcSet="https://source.unsplash.com/ZBstHWt9vLc/400x200 400w, https://source.unsplash.com/ZBstHWt9vLc/600x300 600w, https://source.unsplash.com/ZBstHWt9vLc/960x480 960w"/><div class="MuiCardHeader-root css-faujvq"><div class="MuiCardHeader-content css-11qjisw"><span class="MuiTypography-root MuiTypography-h1 MuiCardHeader-title css-1rcf3o0">Component injection with React.forwardRef</span></div></div><div class="MuiCardContent-root css-1qw96cp"><div class="MuiBox-root css-wmsu9q"><p class="MuiTypography-root MuiTypography-body1 css-9l3uo3">There are two main patterns how to separate concerns into different components in React.
Either - given the concrete implementation to be wrapped - you create a new wrapped component as described in <a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineAlways css-15kjgm" href="https://reactjs.org/docs/higher-order-components.html" target="_blank">React&#x27;s Guide on Higher-Order Components</a> ...</p><pre class="MuiBox-root css-4unpuk"><div class="MuiBox-root css-1ecc1vw">jsx</div><code class="prism-code language-jsx prism-code language-jsx MuiBox-root css-q9xt0v" style="color:#000000;background-color:#ffffff"><div class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createNewWrappedComponent</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token parameter maybe-class-name">WrappedComponent</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(0, 0, 255)">Wrapper</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token parameter">title</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token parameter"> children</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token parameter"> </span><span class="token parameter spread operator" style="color:rgb(0, 0, 0)">...</span><span class="token parameter">others</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag class-name" style="color:rgb(38, 127, 153)">WrappedComponent</span><span class="token tag" style="color:rgb(128, 0, 0)"> </span><span class="token tag spread punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token tag spread operator" style="color:rgb(0, 0, 0)">...</span><span class="token tag spread" style="color:rgb(128, 0, 0)">others</span><span class="token tag spread punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#000000"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">h3</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">title</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">h3</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#000000"><span class="token plain-text">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">children</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain-text"></span></div><div class="token-line" style="color:#000000"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag class-name" style="color:rgb(38, 127, 153)">WrappedComponent</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token maybe-class-name">DivWithTitle</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">createNewWrappedComponent</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token string" style="color:rgb(163, 21, 21)">&quot;div&quot;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">render</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag class-name" style="color:rgb(38, 127, 153)">DivWithTitle</span><span class="token tag" style="color:rgb(128, 0, 0)"> </span><span class="token tag attr-name" style="color:rgb(255, 0, 0)">title</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(4, 81, 165)">=</span><span class="token tag attr-value punctuation" style="color:rgb(4, 81, 165)">&quot;</span><span class="token tag attr-value" style="color:rgb(128, 0, 0)">foo</span><span class="token tag attr-value punctuation" style="color:rgb(4, 81, 165)">&quot;</span><span class="token tag" style="color:rgb(128, 0, 0)"> </span><span class="token tag attr-name" style="color:rgb(255, 0, 0)">className</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(4, 81, 165)">=</span><span class="token tag attr-value punctuation" style="color:rgb(4, 81, 165)">&quot;</span><span class="token tag attr-value" style="color:rgb(128, 0, 0)">bar</span><span class="token tag attr-value punctuation" style="color:rgb(4, 81, 165)">&quot;</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#000000"><span class="token plain-text">    baz</span></div><div class="token-line" style="color:#000000"><span class="token plain-text"></span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag class-name" style="color:rgb(38, 127, 153)">DivWithTitle</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// results in</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">div</span><span class="token tag" style="color:rgb(128, 0, 0)"> </span><span class="token tag attr-name" style="color:rgb(255, 0, 0)">className</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(4, 81, 165)">=</span><span class="token tag attr-value punctuation" style="color:rgb(4, 81, 165)">&quot;</span><span class="token tag attr-value" style="color:rgb(128, 0, 0)">bar</span><span class="token tag attr-value punctuation" style="color:rgb(4, 81, 165)">&quot;</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">h3</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain-text">foo</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">h3</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain-text">baz</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">div</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span></div></code></pre><p class="MuiTypography-root MuiTypography-body1 css-9l3uo3">... or you accept a component as a prop - making the concrete implementation for the wrapped component injectable.</p><pre class="MuiBox-root css-4unpuk"><div class="MuiBox-root css-1ecc1vw">jsx</div><code class="prism-code language-jsx prism-code language-jsx MuiBox-root css-q9xt0v" style="color:#000000;background-color:#ffffff"><div class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(0, 0, 255)">Wrapper</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token parameter maybe-class-name">WrappedComponent</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token parameter"> title</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token parameter"> children</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token parameter"> </span><span class="token parameter spread operator" style="color:rgb(0, 0, 0)">...</span><span class="token parameter">others</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag class-name" style="color:rgb(38, 127, 153)">WrappedComponent</span><span class="token tag" style="color:rgb(128, 0, 0)"> </span><span class="token tag spread punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token tag spread operator" style="color:rgb(0, 0, 0)">...</span><span class="token tag spread" style="color:rgb(128, 0, 0)">others</span><span class="token tag spread punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#000000"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">h3</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">title</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">h3</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#000000"><span class="token plain-text">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">children</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain-text"></span></div><div class="token-line" style="color:#000000"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag class-name" style="color:rgb(38, 127, 153)">WrappedComponent</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#000000"><span class="token plain"></span><span class="token function" style="color:rgb(0, 0, 255)">render</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag class-name" style="color:rgb(38, 127, 153)">Wrapper</span><span class="token tag" style="color:rgb(128, 0, 0)"> </span><span class="token tag attr-name" style="color:rgb(255, 0, 0)">WrappedComponent</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(4, 81, 165)">=</span><span class="token tag attr-value punctuation" style="color:rgb(4, 81, 165)">&quot;</span><span class="token tag attr-value" style="color:rgb(128, 0, 0)">div</span><span class="token tag attr-value punctuation" style="color:rgb(4, 81, 165)">&quot;</span><span class="token tag" style="color:rgb(128, 0, 0)"> </span><span class="token tag attr-name" style="color:rgb(255, 0, 0)">title</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(4, 81, 165)">=</span><span class="token tag attr-value punctuation" style="color:rgb(4, 81, 165)">&quot;</span><span class="token tag attr-value" style="color:rgb(128, 0, 0)">foo</span><span class="token tag attr-value punctuation" style="color:rgb(4, 81, 165)">&quot;</span><span class="token tag" style="color:rgb(128, 0, 0)"> </span><span class="token tag attr-name" style="color:rgb(255, 0, 0)">className</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(4, 81, 165)">=</span><span class="token tag attr-value punctuation" style="color:rgb(4, 81, 165)">&quot;</span><span class="token tag attr-value" style="color:rgb(128, 0, 0)">bar</span><span class="token tag attr-value punctuation" style="color:rgb(4, 81, 165)">&quot;</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#000000"><span class="token plain-text">    bar</span></div><div class="token-line" style="color:#000000"><span class="token plain-text"></span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag class-name" style="color:rgb(38, 127, 153)">Wrapper</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">// results in</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">div</span><span class="token tag" style="color:rgb(128, 0, 0)"> </span><span class="token tag attr-name" style="color:rgb(255, 0, 0)">className</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(4, 81, 165)">=</span><span class="token tag attr-value punctuation" style="color:rgb(4, 81, 165)">&quot;</span><span class="token tag attr-value" style="color:rgb(128, 0, 0)">bar</span><span class="token tag attr-value punctuation" style="color:rgb(4, 81, 165)">&quot;</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">h3</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain-text">foo</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">h3</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain-text">baz</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">div</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span></div></code></pre><p class="MuiTypography-root MuiTypography-body1 css-9l3uo3">When working with Typescript you want all component props to be typed - especially on reused code, no matter if you set the <code class="MuiBox-root css-q9xt0v">WrappedComponent</code> beforehand or per prop.</p><h2>The problem</h2><p class="MuiTypography-root MuiTypography-body1 css-9l3uo3">One can infer props from the injected <code class="MuiBox-root css-q9xt0v">WrappedComponent</code> like this:</p><pre class="MuiBox-root css-4unpuk"><div class="MuiBox-root css-1ecc1vw">tsx</div><code class="prism-code language-tsx prism-code language-tsx MuiBox-root css-q9xt0v" style="color:#000000;background-color:#ffffff"><div class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token maybe-class-name">Wrapper</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token constant" style="color:rgb(129, 31, 63)">T</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">extends</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">React</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access maybe-class-name">ElementType</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">children</span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access maybe-class-name">ReactNode</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token maybe-class-name">WrappedComponent</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> title</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> children</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token spread operator" style="color:rgb(0, 0, 0)">...</span><span class="token plain">others</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token maybe-class-name">WrappedComponent</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">T</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain">    title</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(0, 112, 193)">string</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain"> </span><span class="token maybe-class-name">Omit</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access maybe-class-name">ComponentPropsWithoutRef</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token constant" style="color:rgb(129, 31, 63)">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;WrappedComponent&#x27;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// prevent type widening on this prop</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token string" style="color:rgb(163, 21, 21)">&#x27;title&#x27;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(0, 128, 0)">// remove any other props we don&#x27;t pass down</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain"></span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token property-access maybe-class-name">Element</span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token keyword" style="color:rgb(0, 0, 255)">null</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token comment" style="color:rgb(0, 128, 0)">/// ...</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span></div></code></pre><h3><code class="MuiBox-root css-q9xt0v">Ref</code> is not a regular prop</h3><p class="MuiTypography-root MuiTypography-body1 css-9l3uo3">As <a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineAlways css-15kjgm" href="https://reactjs.org/docs/forwarding-refs.html#forwarding-refs-in-higher-order-components" target="_blank">React&#x27;s Guide on Forwarding Refs</a> points out <code class="MuiBox-root css-q9xt0v">ref</code> it is not passed to regular components.
When one tries to have a <code class="MuiBox-root css-q9xt0v">Wrapper</code> accept a <code class="MuiBox-root css-q9xt0v">ref</code> because one wants it to mimic the behavior of the <code class="MuiBox-root css-q9xt0v">WrappedComponent</code> so it can replace it in some context, it needs to be passed through <code class="MuiBox-root css-q9xt0v">React.forwardRef</code>.</p><pre class="MuiBox-root css-4unpuk"><div class="MuiBox-root css-1ecc1vw">jsx</div><code class="prism-code language-jsx prism-code language-jsx MuiBox-root css-q9xt0v" style="color:#000000;background-color:#ffffff"><div class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token maybe-class-name">ForwardingWrapper</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token method function property-access" style="color:rgb(0, 0, 255)">forwardRef</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:rgb(0, 0, 255)">Wrapper</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token parameter maybe-class-name">WrappedComponent</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token parameter"> title</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token parameter"> children</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token parameter"> </span><span class="token parameter spread operator" style="color:rgb(0, 0, 0)">...</span><span class="token parameter">others</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token parameter"></span></div><div class="token-line" style="color:#000000"><span class="token parameter">    ref</span><span class="token parameter punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword control-flow" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag class-name" style="color:rgb(38, 127, 153)">WrappedComponent</span><span class="token tag" style="color:rgb(128, 0, 0)"> </span><span class="token tag spread punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token tag spread operator" style="color:rgb(0, 0, 0)">...</span><span class="token tag spread" style="color:rgb(128, 0, 0)">others</span><span class="token tag spread punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token tag" style="color:rgb(128, 0, 0)"> </span><span class="token tag attr-name" style="color:rgb(255, 0, 0)">ref</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:rgb(4, 81, 165)">=</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)">ref</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#000000"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">h3</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">title</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">h3</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#000000"><span class="token plain-text">        </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">children</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain-text"></span></div><div class="token-line" style="color:#000000"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag class-name" style="color:rgb(38, 127, 153)">WrappedComponent</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span></div></code></pre><p class="MuiTypography-root MuiTypography-body1 css-9l3uo3">This <code class="MuiBox-root css-q9xt0v">ForwardingWrapper</code> infers its props and types from <code class="MuiBox-root css-q9xt0v">Wrapper</code> but if our <code class="MuiBox-root css-q9xt0v">Wrapper</code> is generically typed like described above this does not work and we end up with basically untyped props (and ref) on <code class="MuiBox-root css-q9xt0v">ForwardingWrapper</code>.
And without knowing the <code class="MuiBox-root css-q9xt0v">WrappedComponent</code> beforehand one can not set the types for ref and props on <code class="MuiBox-root css-q9xt0v">React.forwardRef&lt;T, P&gt;()</code>.</p><h3>Concrete types don&#x27;t match generics</h3><p class="MuiTypography-root MuiTypography-body1 css-9l3uo3">The <code class="MuiBox-root css-q9xt0v">Wrapper</code> as types above has a <code class="MuiBox-root css-q9xt0v">WrappedComponent</code> variable that is typed to <code class="MuiBox-root css-q9xt0v">T</code> which <code class="MuiBox-root css-q9xt0v">extends React.Elements</code> - but it is not <code class="MuiBox-root css-q9xt0v">React.Elements</code> because it could be a different subtype.
(If this does not ring a bell consider yourself lucky. I guess stumbling over <code class="MuiBox-root css-q9xt0v">ts2322</code> at some point and feeling stupid for not seeing the problem at first glance before Typescript yelled is part of the Typescript experience. ;) )</p><pre class="MuiBox-root css-4unpuk"><div class="MuiBox-root css-1ecc1vw">tsx</div><code class="prism-code language-tsx prism-code language-tsx MuiBox-root css-q9xt0v" style="color:#000000;background-color:#ffffff"><div class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> element </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag class-name" style="color:rgb(38, 127, 153)">WrappedComponent</span><span class="token tag" style="color:rgb(128, 0, 0)"> </span><span class="token tag comment" style="color:rgb(0, 128, 0)">// this is T</span><span class="token tag" style="color:rgb(128, 0, 0)"></span></div><div class="token-line" style="color:#000000"><span class="token tag" style="color:rgb(128, 0, 0)">    </span><span class="token tag comment" style="color:rgb(0, 128, 0)">// Props must match ComponentProps&lt;T&gt; &amp; Attributes</span><span class="token tag" style="color:rgb(128, 0, 0)"></span></div><div class="token-line" style="color:#000000"><span class="token tag" style="color:rgb(128, 0, 0)">    </span><span class="token tag comment" style="color:rgb(0, 128, 0)">// But Typescript can not decide if this is the case</span><span class="token tag" style="color:rgb(128, 0, 0)"></span></div><div class="token-line" style="color:#000000"><span class="token tag" style="color:rgb(128, 0, 0)"></span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">/&gt;</span></div></code></pre><p class="MuiTypography-root MuiTypography-body1 css-9l3uo3">Of course one could work around this per <code class="MuiBox-root css-q9xt0v">React.createElement</code> because its props type defaults to <code class="MuiBox-root css-q9xt0v">any</code>. But this kind of defeats the purpose.</p><h2>The solution</h2><p class="MuiTypography-root MuiTypography-body1 css-9l3uo3">By typing <code class="MuiBox-root css-q9xt0v">ForwardingWrapper</code> as a component function that infers its props (including ref) from one of its own props and using Typescript&#x27;s inference from usage for the implementation of <code class="MuiBox-root css-q9xt0v">Wrapper</code> we get the correct types both inside and outside our implementation.</p><p class="MuiTypography-root MuiTypography-body1 css-9l3uo3">First we create generic types for props and ref:</p><pre class="MuiBox-root css-4unpuk"><div class="MuiBox-root css-1ecc1vw">ts</div><code class="prism-code language-ts prism-code language-ts MuiBox-root css-q9xt0v" style="color:#000000;background-color:#ffffff"><div class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)">/**</span></div><div class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"> * Infer the ForwardedRef from a component</span></div><div class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"> */</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">ComponentForwardRef</span><span class="token class-name operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name constant" style="color:rgb(129, 31, 63)">T</span><span class="token class-name" style="color:rgb(38, 127, 153)"> </span><span class="token class-name keyword" style="color:rgb(0, 0, 255)">extends</span><span class="token class-name" style="color:rgb(38, 127, 153)"> React</span><span class="token class-name punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token class-name" style="color:rgb(38, 127, 153)">ElementType</span><span class="token class-name operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> React</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">ForwardedRef</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">React</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">ElementRef</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token constant" style="color:rgb(129, 31, 63)">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#000000"><span class="token plain"></span><span class="token comment" style="color:rgb(0, 128, 0)">/**</span></div><div class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"> * Properties of a wrapper component</span></div><div class="token-line" style="color:#000000"><span class="token comment" style="color:rgb(0, 128, 0)"> */</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">WrapperProps</span><span class="token class-name operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)"></span></div><div class="token-line" style="color:#000000"><span class="token class-name" style="color:rgb(38, 127, 153)">    </span><span class="token class-name comment" style="color:rgb(0, 128, 0)">/**</span></div><div class="token-line" style="color:#000000"><span class="token class-name comment" style="color:rgb(0, 128, 0)">     * The property key for the component to be wrapped.</span></div><div class="token-line" style="color:#000000"><span class="token class-name comment" style="color:rgb(0, 128, 0)">     */</span><span class="token class-name" style="color:rgb(38, 127, 153)"></span></div><div class="token-line" style="color:#000000"><span class="token class-name" style="color:rgb(38, 127, 153)">    ComponentProp </span><span class="token class-name keyword" style="color:rgb(0, 0, 255)">extends</span><span class="token class-name" style="color:rgb(38, 127, 153)"> PropertyKey</span><span class="token class-name punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token class-name" style="color:rgb(38, 127, 153)"></span></div><div class="token-line" style="color:#000000"><span class="token class-name" style="color:rgb(38, 127, 153)">    </span><span class="token class-name comment" style="color:rgb(0, 128, 0)">/**</span></div><div class="token-line" style="color:#000000"><span class="token class-name comment" style="color:rgb(0, 128, 0)">     * Additional properties for the wrapper.</span></div><div class="token-line" style="color:#000000"><span class="token class-name comment" style="color:rgb(0, 128, 0)">     */</span><span class="token class-name" style="color:rgb(38, 127, 153)"></span></div><div class="token-line" style="color:#000000"><span class="token class-name" style="color:rgb(38, 127, 153)">    AdditionalProps </span><span class="token class-name keyword" style="color:rgb(0, 0, 255)">extends</span><span class="token class-name" style="color:rgb(38, 127, 153)"> </span><span class="token class-name builtin" style="color:rgb(0, 112, 193)">unknown</span><span class="token class-name punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token class-name" style="color:rgb(38, 127, 153)"></span></div><div class="token-line" style="color:#000000"><span class="token class-name" style="color:rgb(38, 127, 153)">    </span><span class="token class-name comment" style="color:rgb(0, 128, 0)">/**</span></div><div class="token-line" style="color:#000000"><span class="token class-name comment" style="color:rgb(0, 128, 0)">     * The property key for properties passed down to the wrapped component.</span></div><div class="token-line" style="color:#000000"><span class="token class-name comment" style="color:rgb(0, 128, 0)">     * `unknown` if properties of wrapper and wrapped are merged.</span></div><div class="token-line" style="color:#000000"><span class="token class-name comment" style="color:rgb(0, 128, 0)">     */</span><span class="token class-name" style="color:rgb(38, 127, 153)"></span></div><div class="token-line" style="color:#000000"><span class="token class-name" style="color:rgb(38, 127, 153)">    PropertiesProp </span><span class="token class-name keyword" style="color:rgb(0, 0, 255)">extends</span><span class="token class-name" style="color:rgb(38, 127, 153)"> PropertyKey </span><span class="token class-name operator" style="color:rgb(0, 0, 0)">|</span><span class="token class-name" style="color:rgb(38, 127, 153)"> </span><span class="token class-name builtin" style="color:rgb(0, 112, 193)">unknown</span><span class="token class-name punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token class-name" style="color:rgb(38, 127, 153)"></span></div><div class="token-line" style="color:#000000"><span class="token class-name" style="color:rgb(38, 127, 153)">    </span><span class="token class-name comment" style="color:rgb(0, 128, 0)">/**</span></div><div class="token-line" style="color:#000000"><span class="token class-name comment" style="color:rgb(0, 128, 0)">     * The wrapped component.</span></div><div class="token-line" style="color:#000000"><span class="token class-name comment" style="color:rgb(0, 128, 0)">     */</span><span class="token class-name" style="color:rgb(38, 127, 153)"></span></div><div class="token-line" style="color:#000000"><span class="token class-name" style="color:rgb(38, 127, 153)">    Component </span><span class="token class-name keyword" style="color:rgb(0, 0, 255)">extends</span><span class="token class-name" style="color:rgb(38, 127, 153)"> React</span><span class="token class-name punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token class-name" style="color:rgb(38, 127, 153)">ElementType</span><span class="token class-name punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token class-name" style="color:rgb(38, 127, 153)"></span></div><div class="token-line" style="color:#000000"><span class="token class-name" style="color:rgb(38, 127, 153)"></span><span class="token class-name operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">k </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> ComponentProp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> Component</span></div><div class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain">    PropertiesProp </span><span class="token keyword" style="color:rgb(0, 0, 255)">extends</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">PropertyKey</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">?</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">[</span><span class="token plain">k </span><span class="token keyword" style="color:rgb(0, 0, 255)">in</span><span class="token plain"> PropertiesProp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">]</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> React</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">ComponentProps</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">Component</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> Omit</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">React</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">ComponentProps</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">Component</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">keyof</span><span class="token plain"> AdditionalProps </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> ComponentProp</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">&amp;</span><span class="token plain"> AdditionalProps</span></div></code></pre><p class="MuiTypography-root MuiTypography-body1 css-9l3uo3">We also prepare a generic type that properly describes <code class="MuiBox-root css-q9xt0v">ForwardingWrapper</code>:</p><pre class="MuiBox-root css-4unpuk"><div class="MuiBox-root css-1ecc1vw">ts</div><code class="prism-code language-ts prism-code language-ts MuiBox-root css-q9xt0v" style="color:#000000;background-color:#ffffff"><div class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">interface</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">ForwardRefWrapper</span><span class="token class-name operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)"></span></div><div class="token-line" style="color:#000000"><span class="token class-name" style="color:rgb(38, 127, 153)">    ComponentProp </span><span class="token class-name keyword" style="color:rgb(0, 0, 255)">extends</span><span class="token class-name" style="color:rgb(38, 127, 153)"> PropertyKey</span><span class="token class-name punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token class-name" style="color:rgb(38, 127, 153)"></span></div><div class="token-line" style="color:#000000"><span class="token class-name" style="color:rgb(38, 127, 153)">    AdditionalProps </span><span class="token class-name keyword" style="color:rgb(0, 0, 255)">extends</span><span class="token class-name" style="color:rgb(38, 127, 153)"> </span><span class="token class-name builtin" style="color:rgb(0, 112, 193)">unknown</span><span class="token class-name" style="color:rgb(38, 127, 153)"> </span><span class="token class-name operator" style="color:rgb(0, 0, 0)">=</span><span class="token class-name" style="color:rgb(38, 127, 153)"> </span><span class="token class-name builtin" style="color:rgb(0, 112, 193)">unknown</span><span class="token class-name punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token class-name" style="color:rgb(38, 127, 153)"></span></div><div class="token-line" style="color:#000000"><span class="token class-name" style="color:rgb(38, 127, 153)">    PropertiesProp </span><span class="token class-name keyword" style="color:rgb(0, 0, 255)">extends</span><span class="token class-name" style="color:rgb(38, 127, 153)"> PropertyKey </span><span class="token class-name operator" style="color:rgb(0, 0, 0)">|</span><span class="token class-name" style="color:rgb(38, 127, 153)"> </span><span class="token class-name builtin" style="color:rgb(0, 112, 193)">unknown</span><span class="token class-name" style="color:rgb(38, 127, 153)"> </span><span class="token class-name operator" style="color:rgb(0, 0, 0)">=</span><span class="token class-name" style="color:rgb(38, 127, 153)"> </span><span class="token class-name builtin" style="color:rgb(0, 112, 193)">unknown</span><span class="token class-name punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token class-name" style="color:rgb(38, 127, 153)"></span></div><div class="token-line" style="color:#000000"><span class="token class-name" style="color:rgb(38, 127, 153)">    </span><span class="token class-name comment" style="color:rgb(0, 128, 0)">/**</span></div><div class="token-line" style="color:#000000"><span class="token class-name comment" style="color:rgb(0, 128, 0)">     * Base type for the wrapped component.</span></div><div class="token-line" style="color:#000000"><span class="token class-name comment" style="color:rgb(0, 128, 0)">     */</span><span class="token class-name" style="color:rgb(38, 127, 153)"></span></div><div class="token-line" style="color:#000000"><span class="token class-name" style="color:rgb(38, 127, 153)">    ComponentType </span><span class="token class-name keyword" style="color:rgb(0, 0, 255)">extends</span><span class="token class-name" style="color:rgb(38, 127, 153)"> React</span><span class="token class-name punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token class-name" style="color:rgb(38, 127, 153)">ElementType </span><span class="token class-name operator" style="color:rgb(0, 0, 0)">=</span><span class="token class-name" style="color:rgb(38, 127, 153)"> React</span><span class="token class-name punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token class-name" style="color:rgb(38, 127, 153)">ElementType</span><span class="token class-name punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token class-name" style="color:rgb(38, 127, 153)"></span></div><div class="token-line" style="color:#000000"><span class="token class-name" style="color:rgb(38, 127, 153)"></span><span class="token class-name operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">extends</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">OmitCallable</span><span class="token class-name operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name" style="color:rgb(38, 127, 153)">React</span><span class="token class-name punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token class-name" style="color:rgb(38, 127, 153)">ForwardRefExoticComponent</span><span class="token class-name operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name builtin" style="color:rgb(0, 112, 193)">any</span><span class="token class-name operator" style="color:rgb(0, 0, 0)">&gt;&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token constant" style="color:rgb(129, 31, 63)">T</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">extends</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">ComponentType</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain">        props</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> WrapperProps</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">ComponentProp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> AdditionalProps</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> PropertiesProp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> React</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">ReactElement </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">null</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain"></span><span class="token keyword" style="color:rgb(0, 0, 255)">type</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(38, 127, 153)">OmitCallable</span><span class="token class-name operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token class-name constant" style="color:rgb(129, 31, 63)">T</span><span class="token class-name operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> Pick</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token constant" style="color:rgb(129, 31, 63)">T</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">keyof</span><span class="token plain"> </span><span class="token constant" style="color:rgb(129, 31, 63)">T</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span></div></code></pre><p class="MuiTypography-root MuiTypography-body1 css-9l3uo3">With these types we are ready to write a utility function to create <code class="MuiBox-root css-q9xt0v">React.ForwardRefExoticComponent</code> with our infered typing:</p><pre class="MuiBox-root css-4unpuk"><div class="MuiBox-root css-1ecc1vw">ts</div><code class="prism-code language-ts prism-code language-ts MuiBox-root css-q9xt0v" style="color:#000000;background-color:#ffffff"><div class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token generic-function function" style="color:rgb(0, 0, 255)">createForwardRefWrapper</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"></span></div><div class="token-line" style="color:#000000"><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)">    ComponentProp </span><span class="token generic-function generic class-name keyword" style="color:rgb(0, 0, 255)">extends</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"> PropertyKey</span><span class="token generic-function generic class-name punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"></span></div><div class="token-line" style="color:#000000"><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)">    AdditionalProps </span><span class="token generic-function generic class-name keyword" style="color:rgb(0, 0, 255)">extends</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"> </span><span class="token generic-function generic class-name builtin" style="color:rgb(0, 112, 193)">unknown</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"> </span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">=</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"> </span><span class="token generic-function generic class-name builtin" style="color:rgb(0, 112, 193)">unknown</span><span class="token generic-function generic class-name punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"></span></div><div class="token-line" style="color:#000000"><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)">    PropertiesProp </span><span class="token generic-function generic class-name keyword" style="color:rgb(0, 0, 255)">extends</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"> PropertyKey </span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">|</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"> </span><span class="token generic-function generic class-name builtin" style="color:rgb(0, 112, 193)">unknown</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"> </span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">=</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"> </span><span class="token generic-function generic class-name builtin" style="color:rgb(0, 112, 193)">unknown</span><span class="token generic-function generic class-name punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"></span></div><div class="token-line" style="color:#000000"><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)">    ComponentType </span><span class="token generic-function generic class-name keyword" style="color:rgb(0, 0, 255)">extends</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"> React</span><span class="token generic-function generic class-name punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)">ElementType </span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">=</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"> React</span><span class="token generic-function generic class-name punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)">ElementType</span><span class="token generic-function generic class-name punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"></span></div><div class="token-line" style="color:#000000"><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"></span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token function-variable function" style="color:rgb(0, 0, 255)">wrapper</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain">        props</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> WrapperProps</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">ComponentProp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> AdditionalProps</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> PropertiesProp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> ComponentType</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain">        ref</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> ComponentForwardRef</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">ComponentType</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=&gt;</span><span class="token plain"> React</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token plain">ReactElement </span><span class="token operator" style="color:rgb(0, 0, 0)">|</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(0, 0, 255)">null</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token operator" style="color:rgb(0, 0, 0)">:</span><span class="token plain"> ForwardRefWrapper</span><span class="token operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token plain">ComponentProp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> AdditionalProps</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> PropertiesProp</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> ComponentType</span><span class="token operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> React</span><span class="token punctuation" style="color:rgb(4, 81, 165)">.</span><span class="token function" style="color:rgb(0, 0, 255)">forwardRef</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain">wrapper</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span></div></code></pre><p class="MuiTypography-root MuiTypography-body1 css-9l3uo3">Now we can easily write a type safe wrapper with forwarded <code class="MuiBox-root css-q9xt0v">ref</code>:</p><pre class="MuiBox-root css-4unpuk"><div class="MuiBox-root css-1ecc1vw">tsx</div><code class="prism-code language-tsx prism-code language-tsx MuiBox-root css-q9xt0v" style="color:#000000;background-color:#ffffff"><div class="token-line" style="color:#000000"><span class="token keyword" style="color:rgb(0, 0, 255)">const</span><span class="token plain"> </span><span class="token maybe-class-name">ForwardingWrapper</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 0, 0)">=</span><span class="token plain"> </span><span class="token generic-function function" style="color:rgb(0, 0, 255)">createForwardRefWrapper</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&lt;</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"></span></div><div class="token-line" style="color:#000000"><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)">    </span><span class="token generic-function generic class-name string" style="color:rgb(163, 21, 21)">&#x27;WrappedComponent&#x27;</span><span class="token generic-function generic class-name punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"></span></div><div class="token-line" style="color:#000000"><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)">    </span><span class="token generic-function generic class-name punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)">title</span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">:</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"> </span><span class="token generic-function generic class-name builtin" style="color:rgb(0, 112, 193)">string</span><span class="token generic-function generic class-name punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"></span></div><div class="token-line" style="color:#000000"><span class="token generic-function generic class-name" style="color:rgb(38, 127, 153)"></span><span class="token generic-function generic class-name operator" style="color:rgb(0, 0, 0)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token keyword" style="color:rgb(0, 0, 255)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(0, 0, 255)">Wrapper</span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token maybe-class-name">WrappedComponent</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> title</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> children</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> </span><span class="token spread operator" style="color:rgb(0, 0, 0)">...</span><span class="token plain">others</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">,</span><span class="token plain"> ref</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token keyword" style="color:rgb(0, 0, 255)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(4, 81, 165)">(</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag class-name" style="color:rgb(38, 127, 153)">WrappedComponent</span><span class="token tag" style="color:rgb(128, 0, 0)"></span></div><div class="token-line" style="color:#000000"><span class="token tag" style="color:rgb(128, 0, 0)">            </span><span class="token tag spread punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token tag spread operator" style="color:rgb(0, 0, 0)">...</span><span class="token tag spread" style="color:rgb(128, 0, 0)">others</span><span class="token tag spread punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token tag" style="color:rgb(128, 0, 0)"></span></div><div class="token-line" style="color:#000000"><span class="token tag" style="color:rgb(128, 0, 0)">            </span><span class="token tag attr-name" style="color:rgb(255, 0, 0)">ref</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:rgb(4, 81, 165)">=</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token tag script language-javascript" style="color:rgb(128, 0, 0)">ref</span><span class="token tag script language-javascript punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token tag" style="color:rgb(128, 0, 0)"></span></div><div class="token-line" style="color:#000000"><span class="token tag" style="color:rgb(128, 0, 0)">        </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#000000"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;</span><span class="token tag" style="color:rgb(128, 0, 0)">h3</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">title</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag" style="color:rgb(128, 0, 0)">h3</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#000000"><span class="token plain-text">            </span><span class="token punctuation" style="color:rgb(4, 81, 165)">{</span><span class="token plain">children</span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token plain-text"></span></div><div class="token-line" style="color:#000000"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&lt;/</span><span class="token tag class-name" style="color:rgb(38, 127, 153)">WrappedComponent</span><span class="token tag punctuation" style="color:rgb(4, 81, 165)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#000000"><span class="token plain"></span><span class="token punctuation" style="color:rgb(4, 81, 165)">}</span><span class="token punctuation" style="color:rgb(4, 81, 165)">)</span></div></code></pre><p class="MuiTypography-root MuiTypography-body1 css-9l3uo3">You can import <code class="MuiBox-root css-q9xt0v">createForwardRefWrapper</code> and the utility types from <a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineAlways css-15kjgm" href="https://www.npmjs.com/package/liform-util" target="_blank"><code class="MuiBox-root css-q9xt0v">liform-util</code></a>.</p></div></div><div class="MuiCardActions-root MuiCardActions-spacing css-rlubtd"><a class="MuiButtonBase-root MuiButton-root MuiButton-text MuiButton-textPrimary MuiButton-sizeMedium MuiButton-textSizeMedium MuiButton-root MuiButton-text MuiButton-textPrimary MuiButton-sizeMedium MuiButton-textSizeMedium css-1ujsas3" tabindex="0" href="https://twitter.com/intent/tweet?hashtags=react%2Ctypescript&amp;via=ph_fritsche" target="_blank"><span class="MuiButton-startIcon MuiButton-iconSizeMedium css-6xugel"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 300.00006 244.18703"><g transform="translate(-539.17946,-568.85777)"><path id="path3611" fill-opacity="1" fill-rule="nonzero" stroke="none" d="m 633.89823,812.04479 c 112.46038,0 173.95627,-93.16765 173.95627,-173.95625 0,-2.64628 -0.0539,-5.28062 -0.1726,-7.90305 11.93799,-8.63016 22.31446,-19.39999 30.49762,-31.65984 -10.95459,4.86937 -22.74358,8.14741 -35.11071,9.62551 12.62341,-7.56929 22.31446,-19.54304 26.88583,-33.81739 -11.81284,7.00307 -24.89517,12.09297 -38.82383,14.84055 -11.15723,-11.88436 -27.04079,-19.31655 -44.62892,-19.31655 -33.76374,0 -61.14426,27.38052 -61.14426,61.13233 0,4.79784 0.5364,9.46458 1.58538,13.94057 -50.81546,-2.55686 -95.87353,-26.88582 -126.02546,-63.87991 -5.25082,9.03545 -8.27852,19.53111 -8.27852,30.73006 0,21.21186 10.79366,39.93837 27.20766,50.89296 -10.03077,-0.30992 -19.45363,-3.06348 -27.69044,-7.64676 -0.009,0.25652 -0.009,0.50661 -0.009,0.78077 0,29.60957 21.07478,54.3319 49.0513,59.93435 -5.13757,1.40062 -10.54335,2.15158 -16.12196,2.15158 -3.93364,0 -7.76596,-0.38716 -11.49099,-1.1026 7.78383,24.2932 30.35457,41.97073 57.11525,42.46543 -20.92578,16.40207 -47.28712,26.17062 -75.93712,26.17062 -4.92898,0 -9.79834,-0.28036 -14.58427,-0.84634 27.05868,17.34379 59.18936,27.46396 93.72193,27.46396"></path></g></svg></span>Share</a></div></div></article></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/post/react-forwardref-ts";window.___webpackCompilationHash="f5ab7ce4624d1ab0e50b";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-9850e8d8982e84956fa6.js"],"app":["/app-837bbef2762a5cec13b1.js"],"component---src-pages-404-js":["/component---src-pages-404-js-29c18e577f5c370ec78b.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-e8d21e538fcd12c67b94.js"],"component---src-pages-projects-tsx":["/component---src-pages-projects-tsx-7b4b9edc41d6bdc067b4.js"],"component---src-templates-blog-list-tsx":["/component---src-templates-blog-list-tsx-e28f35591ebdf54dff9c.js"],"component---src-templates-blog-post-tsx":["/component---src-templates-blog-post-tsx-0b21f51ffbd05676e107.js"]};/*]]>*/</script><script src="/polyfill-9850e8d8982e84956fa6.js" nomodule=""></script><script src="/app-837bbef2762a5cec13b1.js" async=""></script><script src="/dc6a8720040df98778fe970bf6c000a41750d3ae-92cf8cee9b79febacf6e.js" async=""></script><script src="/framework-8d129f576944f7bb0f11.js" async=""></script><script src="/webpack-runtime-7c49068b88a4dd97f4ac.js" async=""></script></body></html>