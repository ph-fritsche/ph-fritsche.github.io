{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/blog/post/gatsby-enhanced","result":{"data":{"tags":{"edges":[{"node":{"path":"/blog/tag/gatsby"}},{"node":{"path":"/blog/tag/blog"}},{"node":{"path":"/blog/tag/php"}},{"node":{"path":"/blog/tag/symfony"}},{"node":{"path":"/blog/tag/pitch"}},{"node":{"path":"/blog/tag/react"}},{"node":{"path":"/blog/tag/testing"}},{"node":{"path":"/blog/tag/typescript"}}]},"site":{"siteMetadata":{"author":{"twitter":"ph_fritsche"}}},"mdx":{"body":"var _excluded = [\"components\"];\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n/* @jsxRuntime classic */\n/* @jsx mdx */\n\nvar _frontmatter = {\n  \"title\": \"Gatsby enhanced\",\n  \"tags\": [\"gatsby\", \"blog\"],\n  \"image\": \"https://unsplash.com/photos/M6xNMyYi4H8\",\n  \"description\": \"Save yourself the time and trouble of configuring per trial and error and set up Gatsby with Typescript. A quick guide to an improved Gatsby configuration.\\n\",\n  \"date\": \"2021-05-05T00:00:00.000Z\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"I recently \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/blog/post/launching-a-blog\"\n  }, \"decided to start a blog\"), \" which raised the question what platform to use for this venture. And what kind of developer would I be if I didn't see this as a golden opportunity to learn some new things along the way. I pondered trying out \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.gatsbyjs.com/\"\n  }, \"Gatsby\"), \" for a while now and this was my chance to experience all the gloriousness and dreadfulness of just another ecosystem first hand.\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"A programmer is someone who - when left unattended - lightheartedly spends a couple of days to automate a 30sec task he will use once.\")), mdx(\"h2\", null, \"The docs\"), mdx(\"p\", null, \"One thing that stuck out right away was the abundance of concrete examples and the lack of documentation on the APIs and their parameters.\"), mdx(\"p\", null, \"See for example the entry for \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.gatsbyjs.com/docs/reference/config-files/gatsby-node/#onCreatePage\"\n  }, \"GatsbyNode.onCreatePage\"), \".\\nIt links to an article explaining different use cases in depth, but a listing and explanation which arguments are passed to the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"onCreatePage\"), \" hook are nowhere to be found.\"), mdx(\"p\", null, \"The same could be said for most blog posts I discovered about gatsby. They provided a lot of examples but little explanation on why the tasks at hand are supposed to be tackled this way in a Gatsby environment or how one could build upon the example.\"), mdx(\"h2\", null, \"Typescript support\"), mdx(\"p\", null, \"The lack of API documentation gets a little bit less pressing if your IDE hints you in the right direction when you're working with an API.\"), mdx(\"p\", null, \"So the great news is: Beside the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.gatsbyjs.com/docs/how-to/custom-configuration/typescript/\"\n  }, \"support for Typescript\"), \" for page components there is also a way to tranform (almost) all configuration into Typescript.\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"The cleanest and easiest way I found was per\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.npmjs.com/package/gatsby-plugin-ts-config\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"gatsby-plugin-ts-config\")), \".\\nIt allows to reduce the contents of \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"gatsby-config.js\"), \" in the project root to a bare minimum and select another directory for the rest of the configuration files as well as writing them in Typescript.\"), mdx(\"p\", null, \"Since \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"gatsby\"), \" exports the types being used for the API hooks, this makes writing them a lot less error-prone.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"// gatsby-config.js\\nconst { generateConfig } = require('gatsby-plugin-ts-config');\\n\\nmodule.exports = generateConfig({\\n    projectRoot: __dirname,\\n\\n    // This could by any directory,\\n    // but since there is a lot of the logic how the site is generated,\\n    // I chose to place it with the source.\\n    configDir: `${__dirname}/src/gatsby`,\\n});\\n\")), mdx(\"h2\", null, \"Import paths\"), mdx(\"p\", null, \"One limitation I could not (cleanly) work around was the support for \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"compilerOptions.paths\"), \".\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"You can use \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.npmjs.com/package/ts-node\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"ts-node\")), \" and pass options to it.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"// gatsby-config.js\\nmodule.exports = generateConfig({\\n    babel: false,\\n    tsNode: require(`./tsconfig.json`),\\n})\\n\")), mdx(\"p\", null, \"But sadly this does not work with the same configuration that is required for \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"gatsby build\"), \" to support them too.\\nSo for the moment I decided to give up on paths in config files.\"), mdx(\"p\", null, \"If you set \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"compilerOptions.baseUrl\"), \" the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"compilerOptions.paths\"), \" work fine with Gatsby.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-json\"\n  }, \"{\\n    compilerOptions: {\\n        \\\"baseUrl\\\": \\\".\\\",\\n        \\\"paths\\\": {\\n            \\\"~src/*\\\": [\\\"./src/*\\\"],\\n        },\\n    }\\n}\\n\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-ts\"\n  }, \"import Foo from '~src/component/Foo'\\n\")), mdx(\"h2\", null, \"Typegen\"), mdx(\"p\", null, \"There are multiple plugins for type generation of graphql results and parameters.\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"The one I found working well with Gatsby v3 - although it says it would require Gatsby v2 - is \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.npmjs.com/package/gatsby-plugin-typegen\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"gatsby-plugin-typegen\")), \".\"), mdx(\"p\", null, \"Exporting to a declaration file allows you to use the types across your source files.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-ts\"\n  }, \"// src/gatsby/gatsby-config.ts\\nexport const plugins = [\\n    {\\n        resolve: `gatsby-plugin-typegen`,\\n        options: {\\n            outputPath: `${rootDir}/src/typegen.d.ts`,\\n        },\\n    },\\n}\\n\")), mdx(\"p\", null, \"There are problems with static queries in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"src/pages\"), \", but the following solution works fine and keeps the components clean:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-ts\"\n  }, \"// src/query/foo.ts\\nimport { graphql, useStaticQuery } from 'gatsby'\\n\\nexport const useFooQuery = () => useStaticQuery<GatsbyTypes.FooQuery>(graphql`\\n    query Foo {\\n        site {\\n          siteMetadata {\\n              title\\n          }\\n        }\\n    }\\n`)\\n\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-ts\"\n  }, \"// src/pages/foo.ts\\nimport { useFooQuery } from '~src/query/foo'\\n\\nexport default function Foo() {\\n    const query = useFooQuery()\\n\\n    query.site?.siteMetadata?.title // string | undefined\\n}\\n\")), mdx(\"p\", null, \"This also works well with \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"pageQuery\"), \" for templates.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-ts\"\n  }, \"// src/templates/bar.ts\\nimport { graphql, PageProps } from 'gatsby'\\n\\nexport default function Bar(props: PageProps<GatsbyTypes.BarQuery>) {\\n    props.data.someList.edges // Array<{title?: string}>\\n}\\n\\nexport const pageQuery = graphql`\\n    query Bar($filter: SitePageFilterInput) {\\n        someList: allSitePage(filter: $filter) {\\n            edges {\\n                node {\\n                    title\\n                }\\n            }\\n        }\\n    }\\n`\\n\")), mdx(\"h2\", null, \"Caveat\"), mdx(\"p\", null, \"Changes to the configuration are not picked up properly and require \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"gatsby develop\"), \" to be restarted.\\nBut that's a price I'm willing to pay for not guessing or handcrafting the props structure and types.\"));\n}\n;\nMDXContent.isMDXComponent = true;","meta":{"title":"Gatsby enhanced","date":"2021-05-05T00:00:00.000Z","tags":["gatsby","blog"],"description":"Save yourself the time and trouble of configuring per trial and error and set up Gatsby with Typescript. A quick guide to an improved Gatsby configuration.\n","image":"https://unsplash.com/photos/M6xNMyYi4H8"}}},"pageContext":{"id":"0ed321f6-3b27-5f40-82bf-34761fa8d51c"}},"staticQueryHashes":["1466185270"]}